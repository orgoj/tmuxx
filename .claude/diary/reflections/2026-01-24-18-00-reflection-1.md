# Reflection: Last 4 Entries

**Generated**: 2026-01-24 18:00
**Entries Analyzed**: 4
**Date Range**: 2026-01-23 to 2026-01-24

## Summary

This reflection covers 4 diary entries spanning two days of development on tmuxcc. The sessions were heavily focused on planning and design work rather than implementation, with three major plans created: popup input dialog, isolated testing system, and filter/navigation fix.

A consistent theme across all entries is the user's expectation of detailed technical review cycles - plans are submitted with explicit code patterns, user catches edge cases and API issues, and corrections are applied before implementation begins. The working directory discipline (`cd` prohibition) was violated once and explicitly caught by the user, demonstrating its importance.

The most significant technical insight is the View/Model mismatch anti-pattern identified in entry 4 - when filtering affects display but navigation uses unfiltered indices, users experience erratic cursor behavior. This pattern ("always work only with what you see") should be generalized.

## Patterns Identified

### Strong Patterns (3+ occurrences)

1. **Plan mode with user technical review** (4/4 entries)
   - Observation: Every session involved creating detailed plans that user reviewed and corrected
   - User catches: off-by-one errors, API misuse, missing edge cases, config integration gaps
   - CLAUDE.md rule: Already exists ("Expect user technical review to catch edge cases")

2. **Ask about use case before designing** (3/4 entries)
   - Observation: Sessions that asked early about specific use case produced better designs
   - Entry 1: "Should have asked 'what will this popup be used for?' earlier"
   - Entry 4: "Ask user for design decisions on edge cases early"
   - CLAUDE.md rule: `- Ask about specific use case BEFORE designing architecture`

3. **UTF-8 cursor/text safety** (3/4 entries)
   - Observation: Multiple references to `char_indices()`, never byte slicing
   - Already in CLAUDE.md as "Unicode Safety" principle
   - No change needed

### Emerging Patterns (2 occurrences)

1. **Comprehensive method/API audit** (2/4 entries)
   - Entry 1: "Read ALL related components (HelpWidget, InputWidget) to copy patterns"
   - Entry 4: "Comprehensive audit found 5 methods, not just navigation"
   - CLAUDE.md rule: `- When fixing one method, audit entire API for same pattern`

2. **git commit --only for selective commits** (2/4 entries)
   - Entry 3: "use `git commit --only docs/plans/...` to commit just one file"
   - User prefers granular control over what gets committed
   - CLAUDE.md rule: `- Use git commit --only <file> for selective commits (keeps others staged)`

3. **View/Model mismatch anti-pattern** (2/4 entries)
   - Entry 4: Filter-only display with unfiltered navigation causes erratic cursor
   - Principle: "Always work only with what you see"
   - CLAUDE.md rule: `- View/Model mismatch: When filtering display, navigation MUST use filtered indices`

### Rule Violations Detected

1. **cd discipline violation** (Entry 2)
   - Rule: "NEVER use cd" / "ALWAYS maintain working directory at project root"
   - Violation: `cd .claude/skills && for file in ...`
   - User caught: "kdyzbys dodrzoval zakaz cd, a pouzival ho jen v subshell..."
   - Action: Rule already exists, no strengthening needed - just follow it

2. **Relative path prefix violation** (Entry 2)
   - Rule: Dippy requires `./` prefix for relative paths
   - Violation: `mkdir -p "$skillname"` without `./`
   - Action: This is a Dippy safety rule, not CLAUDE.md - no change needed

## Proposed CLAUDE.md Updates

### Common Pitfalls section (add items 13-15)

```markdown
13. **View/Model Index Mismatch**: When filtering affects display, navigation MUST use filtered indices - otherwise cursor lands on hidden items or skips erratically
14. **Single Method Fix Tunnel Vision**: When fixing one method, audit entire API for same pattern - often multiple methods have the same issue
15. **Designing Before Understanding Use Case**: Ask "what will this be used for?" before architecture design - specific use cases beat generic abstractions
```

### Git workflow note (add to existing git-related section)

```markdown
- Use `git commit --only <file>` for selective commits while keeping other changes staged
```

## One-Off Observations

- Entry 3: `tests/common/mod.rs` is treated as test file by cargo - use `tests/common.rs` instead
- Entry 3: tmux socket isolation (`-L socket-name`) creates completely isolated server
- Entry 1: Ratatui popup pattern with `centered_popup()` for both width and height percentages
- Entry 2: Skill files MUST be `directory/SKILL.md`, not `skill.md` files

## Skills/Commands Updated

No skill file updates needed - feedback was either "worked well" or "N/A".

## Metadata

- Entries analyzed:
  - 2026-01-23-20-30-a0086eeb.md (popup input dialog planning)
  - 2026-01-23-23-00-5c9b5b46.md (feature ideas, skill structure fix)
  - 2026-01-24-07-40-8f18972d.md (isolated testing system planning)
  - 2026-01-24-17-30-042bad47.md (filter/navigation mismatch analysis)
